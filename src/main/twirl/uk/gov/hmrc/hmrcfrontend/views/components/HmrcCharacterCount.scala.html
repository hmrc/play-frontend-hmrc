@*
 * Copyright 2023 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import uk.gov.hmrc.govukfrontend.views.html.components.GovukCharacterCount
@import uk.gov.hmrc.govukfrontend.views.Aliases.{CharacterCount => GovukFrontendCharacterCount}

@this(govukCharacterCount: GovukCharacterCount)
@(params: CharacterCount)(implicit messages: Messages)
@import params._

@require(name.nonEmpty && id.nonEmpty, "name and id should be non-empty")
@require(maxLength.isDefined || maxWords.isDefined, "maxLength or maxWords should be provided")

@defining(if(params.language == Cy || messages.lang.code == "cy") Cy else En) { messagesLanguage =>
 @if(messagesLanguage == Cy) {
  @defining(
   messages match {
    case messagesImpl: MessagesImpl => messagesImpl.messagesApi.preferred(Seq(Lang("cy")))
    case _ => messages
   }
  ) { welshMessages =>
   @govukCharacterCount(GovukFrontendCharacterCount(
    id = params.id,
    name = params.name,
    rows = params.rows,
    value = params.value,
    maxLength = params.maxLength,
    maxWords = params.maxWords,
    threshold = params.threshold,
    label = params.label,
    hint = params.hint,
    errorMessage = params.errorMessage,
    formGroupClasses = params.formGroupClasses,
    classes = params.classes,
    attributes = params.attributes,
    countMessageClasses = params.countMessageClasses,
    textareaDescriptionText = Some(
     if(params.maxWords.isDefined) welshMessages("charactercount.maxwords", params.maxWords.getOrElse(0))
     else welshMessages("charactercount.maxcharacters", params.maxLength.getOrElse(0))
    ),
    charactersUnderLimitText = Some(Map(
     "other" -> welshMessages("charactercount.charactersunderlimit.plural"),
     "one" -> welshMessages("charactercount.charactersunderlimit.singular")
    )),
    charactersAtLimitText = Some(welshMessages("charactercount.charactersatlimit")),
    charactersOverLimitText = Some(Map(
     "other" -> welshMessages("charactercount.charactersoverlimit.plural"),
     "one" -> welshMessages("charactercount.charactersoverlimit.singular")
    )),
    wordsUnderLimitText = Some(Map(
     "other" -> welshMessages("charactercount.wordsunderlimit.plural"),
     "one" -> welshMessages("charactercount.wordsunderlimit.singular")
    )),
    wordsAtLimitText = Some(welshMessages("charactercount.wordsatlimit")),
    wordsOverLimitText = Some(Map(
     "other" -> welshMessages("charactercount.wordsoverlimit.plural"),
     "one" -> welshMessages("charactercount.wordsoverlimit.singular")
    ))
   ))
  }
 } else {
  @govukCharacterCount(GovukFrontendCharacterCount(
   id = params.id,
   name = params.name,
   rows = params.rows,
   value = params.value,
   maxLength = params.maxLength,
   maxWords = params.maxWords,
   threshold = params.threshold,
   label = params.label,
   hint = params.hint,
   errorMessage = params.errorMessage,
   formGroupClasses = params.formGroupClasses,
   classes = params.classes,
   attributes = params.attributes,
   countMessageClasses = params.countMessageClasses
  ))
 }
}
